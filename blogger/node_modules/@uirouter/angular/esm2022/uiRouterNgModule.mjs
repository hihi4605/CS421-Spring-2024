import { UIROUTER_MODULE_TOKEN, UIROUTER_ROOT_MODULE } from './injectionTokens';
import { NgModule, APP_INITIALIZER, } from '@angular/core';
import { CommonModule, LocationStrategy, HashLocationStrategy, PathLocationStrategy } from '@angular/common';
import { _UIROUTER_DIRECTIVES } from './directives/directives';
import { TransitionService } from '@uirouter/core';
import { _UIROUTER_INSTANCE_PROVIDERS, _UIROUTER_SERVICE_PROVIDERS } from './providers';
import * as i0 from "@angular/core";
import * as i1 from "./directives/uiSref";
import * as i2 from "./directives/uiView";
import * as i3 from "./directives/uiSrefActive";
import * as i4 from "./directives/uiSrefStatus";
// Delay angular bootstrap until first transition is successful, for SSR.
// See https://github.com/ui-router/angular/pull/127
export function onTransitionReady(transitionService, root) {
    const mod = root[0];
    if (!mod || !mod.deferInitialRender) {
        return () => Promise.resolve();
    }
    return () => new Promise((resolve) => {
        const hook = (trans) => {
            trans.promise.then(resolve, resolve);
        };
        transitionService.onStart({}, hook, { invokeLimit: 1 });
    });
}
export function makeRootProviders(module) {
    return [
        { provide: UIROUTER_ROOT_MODULE, useValue: module, multi: true },
        { provide: UIROUTER_MODULE_TOKEN, useValue: module, multi: true },
        {
            provide: APP_INITIALIZER,
            useFactory: onTransitionReady,
            deps: [TransitionService, UIROUTER_ROOT_MODULE],
            multi: true,
        },
    ];
}
export function makeChildProviders(module) {
    return [
        { provide: UIROUTER_MODULE_TOKEN, useValue: module, multi: true },
    ];
}
export function locationStrategy(useHash) {
    return { provide: LocationStrategy, useClass: useHash ? HashLocationStrategy : PathLocationStrategy };
}
/**
 * Creates UI-Router Modules
 *
 * This class has two static factory methods which create UIRouter Modules.
 * A UI-Router Module is an [Angular NgModule](https://angular.io/docs/ts/latest/guide/ngmodule.html)
 * with support for UI-Router.
 *
 * ### UIRouter Directives
 *
 * When a UI-Router Module is imported into a `NgModule`, that module's components
 * can use the UIRouter Directives such as [[UIView]], [[UISref]], [[UISrefActive]].
 *
 * ### State Definitions
 *
 * State definitions found in the `states:` property are provided to the Dependency Injector.
 * This enables UI-Router to automatically register the states with the [[StateRegistry]] at bootstrap (and during lazy load).
 */
export class UIRouterModule {
    /**
     * Creates a UI-Router Module for the root (bootstrapped) application module to import
     *
     * This factory function creates an [Angular NgModule](https://angular.io/docs/ts/latest/guide/ngmodule.html)
     * with UI-Router support.
     *
     * The `forRoot` module should be added to the `imports:` of the `NgModule` being bootstrapped.
     * An application should only create and import a single `NgModule` using `forRoot()`.
     * All other modules should be created using [[UIRouterModule.forChild]].
     *
     * Unlike `forChild`, an `NgModule` returned by this factory provides the [[UIRouter]] singleton object.
     * This factory also accepts root-level router configuration.
     * These are the only differences between `forRoot` and `forChild`.
     *
     * Example:
     * ```js
     * let routerConfig = {
     *   otherwise: '/home',
     *   states: [homeState, aboutState]
     * };
     *
     * @ NgModule({
     *   imports: [
     *     BrowserModule,
     *     UIRouterModule.forRoot(routerConfig),
     *     FeatureModule1
     *   ]
     * })
     * class MyRootAppModule {}
     *
     * browserPlatformDynamic.bootstrapModule(MyRootAppModule);
     * ```
     *
     * @param config declarative UI-Router configuration
     * @returns an `NgModule` which provides the [[UIRouter]] singleton instance
     */
    static forRoot(config = {}) {
        return {
            ngModule: UIRouterModule,
            providers: [
                _UIROUTER_INSTANCE_PROVIDERS,
                _UIROUTER_SERVICE_PROVIDERS,
                locationStrategy(config.useHash),
                ...makeRootProviders(config),
            ],
        };
    }
    /**
     * Creates an `NgModule` for a UIRouter module
     *
     * This function creates an [Angular NgModule](https://angular.io/docs/ts/latest/guide/ngmodule.html)
     * with UI-Router support.
     *
     * #### Example:
     * ```js
     * var homeState = { name: 'home', url: '/home', component: Home };
     * var aboutState = { name: 'about', url: '/about', component: About };
     *
     * @ NgModule({
     *   imports: [
     *     UIRouterModule.forChild({ states: [ homeState, aboutState ] }),
     *     SharedModule,
     *   ],
     *   declarations: [ Home, About ],
     * })
     * export class AppModule {};
     * ```
     *
     * @param module UI-Router module options
     * @returns an `NgModule`
     */
    static forChild(module = {}) {
        return {
            ngModule: UIRouterModule,
            providers: makeChildProviders(module),
        };
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.0.9", ngImport: i0, type: UIRouterModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });
    static ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: "14.0.0", version: "17.0.9", ngImport: i0, type: UIRouterModule, declarations: [i1.UISref, i1.AnchorUISref, i2.UIView, i3.UISrefActive, i4.UISrefStatus], imports: [CommonModule], exports: [i1.UISref, i1.AnchorUISref, i2.UIView, i3.UISrefActive, i4.UISrefStatus] });
    static ɵinj = i0.ɵɵngDeclareInjector({ minVersion: "12.0.0", version: "17.0.9", ngImport: i0, type: UIRouterModule, imports: [CommonModule] });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.0.9", ngImport: i0, type: UIRouterModule, decorators: [{
            type: NgModule,
            args: [{
                    imports: [CommonModule],
                    declarations: [_UIROUTER_DIRECTIVES],
                    exports: [_UIROUTER_DIRECTIVES],
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWlSb3V0ZXJOZ01vZHVsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91aVJvdXRlck5nTW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRWhGLE9BQU8sRUFDTCxRQUFRLEVBSVIsZUFBZSxHQUNoQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsWUFBWSxFQUFFLGdCQUFnQixFQUFFLG9CQUFvQixFQUFFLG9CQUFvQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDN0csT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFFL0QsT0FBTyxFQUEyRCxpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzVHLE9BQU8sRUFBRSw0QkFBNEIsRUFBRSwyQkFBMkIsRUFBRSxNQUFNLGFBQWEsQ0FBQzs7Ozs7O0FBRXhGLHlFQUF5RTtBQUN6RSxvREFBb0Q7QUFDcEQsTUFBTSxVQUFVLGlCQUFpQixDQUFDLGlCQUFvQyxFQUFFLElBQWtCO0lBQ3hGLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNwQixJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGtCQUFrQixFQUFFO1FBQ25DLE9BQU8sR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO0tBQ2hDO0lBRUQsT0FBTyxHQUFHLEVBQUUsQ0FDVixJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFO1FBQ3RCLE1BQU0sSUFBSSxHQUFHLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDckIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQztRQUNGLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsV0FBVyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDMUQsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBRUQsTUFBTSxVQUFVLGlCQUFpQixDQUFDLE1BQWtCO0lBQ2xELE9BQU87UUFDTCxFQUFFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUU7UUFDaEUsRUFBRSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFO1FBQ2pFO1lBQ0UsT0FBTyxFQUFFLGVBQWU7WUFDeEIsVUFBVSxFQUFFLGlCQUFpQjtZQUM3QixJQUFJLEVBQUUsQ0FBQyxpQkFBaUIsRUFBRSxvQkFBb0IsQ0FBQztZQUMvQyxLQUFLLEVBQUUsSUFBSTtTQUNaO0tBQ0YsQ0FBQztBQUNKLENBQUM7QUFFRCxNQUFNLFVBQVUsa0JBQWtCLENBQUMsTUFBb0I7SUFDckQsT0FBTztRQUNMLEVBQUUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRTtLQUNsRSxDQUFDO0FBQ0osQ0FBQztBQUVELE1BQU0sVUFBVSxnQkFBZ0IsQ0FBQyxPQUFPO0lBQ3RDLE9BQU8sRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixFQUFFLENBQUM7QUFDeEcsQ0FBQztBQUVEOzs7Ozs7Ozs7Ozs7Ozs7O0dBZ0JHO0FBTUgsTUFBTSxPQUFPLGNBQWM7SUFDekI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O09BbUNHO0lBQ0gsTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFxQixFQUFFO1FBQ3BDLE9BQU87WUFDTCxRQUFRLEVBQUUsY0FBYztZQUN4QixTQUFTLEVBQUU7Z0JBQ1QsNEJBQTRCO2dCQUM1QiwyQkFBMkI7Z0JBQzNCLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUM7Z0JBQ2hDLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDO2FBQzdCO1NBQ0YsQ0FBQztJQUNKLENBQUM7SUFFRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7T0F1Qkc7SUFDSCxNQUFNLENBQUMsUUFBUSxDQUFDLFNBQXVCLEVBQUU7UUFDdkMsT0FBTztZQUNMLFFBQVEsRUFBRSxjQUFjO1lBQ3hCLFNBQVMsRUFBRSxrQkFBa0IsQ0FBQyxNQUFNLENBQUM7U0FDdEMsQ0FBQztJQUNKLENBQUM7dUdBOUVVLGNBQWM7d0dBQWQsY0FBYyxxR0FKZixZQUFZO3dHQUlYLGNBQWMsWUFKZixZQUFZOzsyRkFJWCxjQUFjO2tCQUwxQixRQUFRO21CQUFDO29CQUNSLE9BQU8sRUFBRSxDQUFDLFlBQVksQ0FBQztvQkFDdkIsWUFBWSxFQUFFLENBQUMsb0JBQW9CLENBQUM7b0JBQ3BDLE9BQU8sRUFBRSxDQUFDLG9CQUFvQixDQUFDO2lCQUNoQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFVJUk9VVEVSX01PRFVMRV9UT0tFTiwgVUlST1VURVJfUk9PVF9NT0RVTEUgfSBmcm9tICcuL2luamVjdGlvblRva2Vucyc7XG5pbXBvcnQgeyBOZzJTdGF0ZURlY2xhcmF0aW9uIH0gZnJvbSAnLi9pbnRlcmZhY2UnO1xuaW1wb3J0IHtcbiAgTmdNb2R1bGUsXG4gIE1vZHVsZVdpdGhQcm92aWRlcnMsXG4gIFByb3ZpZGVyLFxuICBJbmplY3RvcixcbiAgQVBQX0lOSVRJQUxJWkVSLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSwgTG9jYXRpb25TdHJhdGVneSwgSGFzaExvY2F0aW9uU3RyYXRlZ3ksIFBhdGhMb2NhdGlvblN0cmF0ZWd5IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IF9VSVJPVVRFUl9ESVJFQ1RJVkVTIH0gZnJvbSAnLi9kaXJlY3RpdmVzL2RpcmVjdGl2ZXMnO1xuaW1wb3J0IHsgVUlWaWV3IH0gZnJvbSAnLi9kaXJlY3RpdmVzL3VpVmlldyc7XG5pbXBvcnQgeyBVcmxSdWxlSGFuZGxlckZuLCBUYXJnZXRTdGF0ZSwgVGFyZ2V0U3RhdGVEZWYsIFVJUm91dGVyLCBUcmFuc2l0aW9uU2VydmljZSB9IGZyb20gJ0B1aXJvdXRlci9jb3JlJztcbmltcG9ydCB7IF9VSVJPVVRFUl9JTlNUQU5DRV9QUk9WSURFUlMsIF9VSVJPVVRFUl9TRVJWSUNFX1BST1ZJREVSUyB9IGZyb20gJy4vcHJvdmlkZXJzJztcblxuLy8gRGVsYXkgYW5ndWxhciBib290c3RyYXAgdW50aWwgZmlyc3QgdHJhbnNpdGlvbiBpcyBzdWNjZXNzZnVsLCBmb3IgU1NSLlxuLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91aS1yb3V0ZXIvYW5ndWxhci9wdWxsLzEyN1xuZXhwb3J0IGZ1bmN0aW9uIG9uVHJhbnNpdGlvblJlYWR5KHRyYW5zaXRpb25TZXJ2aWNlOiBUcmFuc2l0aW9uU2VydmljZSwgcm9vdDogUm9vdE1vZHVsZVtdKSB7XG4gIGNvbnN0IG1vZCA9IHJvb3RbMF07XG4gIGlmICghbW9kIHx8ICFtb2QuZGVmZXJJbml0aWFsUmVuZGVyKSB7XG4gICAgcmV0dXJuICgpID0+IFByb21pc2UucmVzb2x2ZSgpO1xuICB9XG5cbiAgcmV0dXJuICgpID0+XG4gICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIGNvbnN0IGhvb2sgPSAodHJhbnMpID0+IHtcbiAgICAgICAgdHJhbnMucHJvbWlzZS50aGVuKHJlc29sdmUsIHJlc29sdmUpO1xuICAgICAgfTtcbiAgICAgIHRyYW5zaXRpb25TZXJ2aWNlLm9uU3RhcnQoe30sIGhvb2ssIHsgaW52b2tlTGltaXQ6IDEgfSk7XG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlUm9vdFByb3ZpZGVycyhtb2R1bGU6IFJvb3RNb2R1bGUpOiBQcm92aWRlcltdIHtcbiAgcmV0dXJuIFtcbiAgICB7IHByb3ZpZGU6IFVJUk9VVEVSX1JPT1RfTU9EVUxFLCB1c2VWYWx1ZTogbW9kdWxlLCBtdWx0aTogdHJ1ZSB9LFxuICAgIHsgcHJvdmlkZTogVUlST1VURVJfTU9EVUxFX1RPS0VOLCB1c2VWYWx1ZTogbW9kdWxlLCBtdWx0aTogdHJ1ZSB9LFxuICAgIHtcbiAgICAgIHByb3ZpZGU6IEFQUF9JTklUSUFMSVpFUixcbiAgICAgIHVzZUZhY3Rvcnk6IG9uVHJhbnNpdGlvblJlYWR5LFxuICAgICAgZGVwczogW1RyYW5zaXRpb25TZXJ2aWNlLCBVSVJPVVRFUl9ST09UX01PRFVMRV0sXG4gICAgICBtdWx0aTogdHJ1ZSxcbiAgICB9LFxuICBdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFrZUNoaWxkUHJvdmlkZXJzKG1vZHVsZTogU3RhdGVzTW9kdWxlKTogUHJvdmlkZXJbXSB7XG4gIHJldHVybiBbXG4gICAgeyBwcm92aWRlOiBVSVJPVVRFUl9NT0RVTEVfVE9LRU4sIHVzZVZhbHVlOiBtb2R1bGUsIG11bHRpOiB0cnVlIH0sXG4gIF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2NhdGlvblN0cmF0ZWd5KHVzZUhhc2gpIHtcbiAgcmV0dXJuIHsgcHJvdmlkZTogTG9jYXRpb25TdHJhdGVneSwgdXNlQ2xhc3M6IHVzZUhhc2ggPyBIYXNoTG9jYXRpb25TdHJhdGVneSA6IFBhdGhMb2NhdGlvblN0cmF0ZWd5IH07XG59XG5cbi8qKlxuICogQ3JlYXRlcyBVSS1Sb3V0ZXIgTW9kdWxlc1xuICpcbiAqIFRoaXMgY2xhc3MgaGFzIHR3byBzdGF0aWMgZmFjdG9yeSBtZXRob2RzIHdoaWNoIGNyZWF0ZSBVSVJvdXRlciBNb2R1bGVzLlxuICogQSBVSS1Sb3V0ZXIgTW9kdWxlIGlzIGFuIFtBbmd1bGFyIE5nTW9kdWxlXShodHRwczovL2FuZ3VsYXIuaW8vZG9jcy90cy9sYXRlc3QvZ3VpZGUvbmdtb2R1bGUuaHRtbClcbiAqIHdpdGggc3VwcG9ydCBmb3IgVUktUm91dGVyLlxuICpcbiAqICMjIyBVSVJvdXRlciBEaXJlY3RpdmVzXG4gKlxuICogV2hlbiBhIFVJLVJvdXRlciBNb2R1bGUgaXMgaW1wb3J0ZWQgaW50byBhIGBOZ01vZHVsZWAsIHRoYXQgbW9kdWxlJ3MgY29tcG9uZW50c1xuICogY2FuIHVzZSB0aGUgVUlSb3V0ZXIgRGlyZWN0aXZlcyBzdWNoIGFzIFtbVUlWaWV3XV0sIFtbVUlTcmVmXV0sIFtbVUlTcmVmQWN0aXZlXV0uXG4gKlxuICogIyMjIFN0YXRlIERlZmluaXRpb25zXG4gKlxuICogU3RhdGUgZGVmaW5pdGlvbnMgZm91bmQgaW4gdGhlIGBzdGF0ZXM6YCBwcm9wZXJ0eSBhcmUgcHJvdmlkZWQgdG8gdGhlIERlcGVuZGVuY3kgSW5qZWN0b3IuXG4gKiBUaGlzIGVuYWJsZXMgVUktUm91dGVyIHRvIGF1dG9tYXRpY2FsbHkgcmVnaXN0ZXIgdGhlIHN0YXRlcyB3aXRoIHRoZSBbW1N0YXRlUmVnaXN0cnldXSBhdCBib290c3RyYXAgKGFuZCBkdXJpbmcgbGF6eSBsb2FkKS5cbiAqL1xuQE5nTW9kdWxlKHtcbiAgaW1wb3J0czogW0NvbW1vbk1vZHVsZV0sXG4gIGRlY2xhcmF0aW9uczogW19VSVJPVVRFUl9ESVJFQ1RJVkVTXSxcbiAgZXhwb3J0czogW19VSVJPVVRFUl9ESVJFQ1RJVkVTXSxcbn0pXG5leHBvcnQgY2xhc3MgVUlSb3V0ZXJNb2R1bGUge1xuICAvKipcbiAgICogQ3JlYXRlcyBhIFVJLVJvdXRlciBNb2R1bGUgZm9yIHRoZSByb290IChib290c3RyYXBwZWQpIGFwcGxpY2F0aW9uIG1vZHVsZSB0byBpbXBvcnRcbiAgICpcbiAgICogVGhpcyBmYWN0b3J5IGZ1bmN0aW9uIGNyZWF0ZXMgYW4gW0FuZ3VsYXIgTmdNb2R1bGVdKGh0dHBzOi8vYW5ndWxhci5pby9kb2NzL3RzL2xhdGVzdC9ndWlkZS9uZ21vZHVsZS5odG1sKVxuICAgKiB3aXRoIFVJLVJvdXRlciBzdXBwb3J0LlxuICAgKlxuICAgKiBUaGUgYGZvclJvb3RgIG1vZHVsZSBzaG91bGQgYmUgYWRkZWQgdG8gdGhlIGBpbXBvcnRzOmAgb2YgdGhlIGBOZ01vZHVsZWAgYmVpbmcgYm9vdHN0cmFwcGVkLlxuICAgKiBBbiBhcHBsaWNhdGlvbiBzaG91bGQgb25seSBjcmVhdGUgYW5kIGltcG9ydCBhIHNpbmdsZSBgTmdNb2R1bGVgIHVzaW5nIGBmb3JSb290KClgLlxuICAgKiBBbGwgb3RoZXIgbW9kdWxlcyBzaG91bGQgYmUgY3JlYXRlZCB1c2luZyBbW1VJUm91dGVyTW9kdWxlLmZvckNoaWxkXV0uXG4gICAqXG4gICAqIFVubGlrZSBgZm9yQ2hpbGRgLCBhbiBgTmdNb2R1bGVgIHJldHVybmVkIGJ5IHRoaXMgZmFjdG9yeSBwcm92aWRlcyB0aGUgW1tVSVJvdXRlcl1dIHNpbmdsZXRvbiBvYmplY3QuXG4gICAqIFRoaXMgZmFjdG9yeSBhbHNvIGFjY2VwdHMgcm9vdC1sZXZlbCByb3V0ZXIgY29uZmlndXJhdGlvbi5cbiAgICogVGhlc2UgYXJlIHRoZSBvbmx5IGRpZmZlcmVuY2VzIGJldHdlZW4gYGZvclJvb3RgIGFuZCBgZm9yQ2hpbGRgLlxuICAgKlxuICAgKiBFeGFtcGxlOlxuICAgKiBgYGBqc1xuICAgKiBsZXQgcm91dGVyQ29uZmlnID0ge1xuICAgKiAgIG90aGVyd2lzZTogJy9ob21lJyxcbiAgICogICBzdGF0ZXM6IFtob21lU3RhdGUsIGFib3V0U3RhdGVdXG4gICAqIH07XG4gICAqXG4gICAqIEAgTmdNb2R1bGUoe1xuICAgKiAgIGltcG9ydHM6IFtcbiAgICogICAgIEJyb3dzZXJNb2R1bGUsXG4gICAqICAgICBVSVJvdXRlck1vZHVsZS5mb3JSb290KHJvdXRlckNvbmZpZyksXG4gICAqICAgICBGZWF0dXJlTW9kdWxlMVxuICAgKiAgIF1cbiAgICogfSlcbiAgICogY2xhc3MgTXlSb290QXBwTW9kdWxlIHt9XG4gICAqXG4gICAqIGJyb3dzZXJQbGF0Zm9ybUR5bmFtaWMuYm9vdHN0cmFwTW9kdWxlKE15Um9vdEFwcE1vZHVsZSk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gY29uZmlnIGRlY2xhcmF0aXZlIFVJLVJvdXRlciBjb25maWd1cmF0aW9uXG4gICAqIEByZXR1cm5zIGFuIGBOZ01vZHVsZWAgd2hpY2ggcHJvdmlkZXMgdGhlIFtbVUlSb3V0ZXJdXSBzaW5nbGV0b24gaW5zdGFuY2VcbiAgICovXG4gIHN0YXRpYyBmb3JSb290KGNvbmZpZzogUm9vdE1vZHVsZSA9IHt9KTogTW9kdWxlV2l0aFByb3ZpZGVyczxVSVJvdXRlck1vZHVsZT4ge1xuICAgIHJldHVybiB7XG4gICAgICBuZ01vZHVsZTogVUlSb3V0ZXJNb2R1bGUsXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgX1VJUk9VVEVSX0lOU1RBTkNFX1BST1ZJREVSUyxcbiAgICAgICAgX1VJUk9VVEVSX1NFUlZJQ0VfUFJPVklERVJTLFxuICAgICAgICBsb2NhdGlvblN0cmF0ZWd5KGNvbmZpZy51c2VIYXNoKSxcbiAgICAgICAgLi4ubWFrZVJvb3RQcm92aWRlcnMoY29uZmlnKSxcbiAgICAgIF0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGBOZ01vZHVsZWAgZm9yIGEgVUlSb3V0ZXIgbW9kdWxlXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb24gY3JlYXRlcyBhbiBbQW5ndWxhciBOZ01vZHVsZV0oaHR0cHM6Ly9hbmd1bGFyLmlvL2RvY3MvdHMvbGF0ZXN0L2d1aWRlL25nbW9kdWxlLmh0bWwpXG4gICAqIHdpdGggVUktUm91dGVyIHN1cHBvcnQuXG4gICAqXG4gICAqICMjIyMgRXhhbXBsZTpcbiAgICogYGBganNcbiAgICogdmFyIGhvbWVTdGF0ZSA9IHsgbmFtZTogJ2hvbWUnLCB1cmw6ICcvaG9tZScsIGNvbXBvbmVudDogSG9tZSB9O1xuICAgKiB2YXIgYWJvdXRTdGF0ZSA9IHsgbmFtZTogJ2Fib3V0JywgdXJsOiAnL2Fib3V0JywgY29tcG9uZW50OiBBYm91dCB9O1xuICAgKlxuICAgKiBAIE5nTW9kdWxlKHtcbiAgICogICBpbXBvcnRzOiBbXG4gICAqICAgICBVSVJvdXRlck1vZHVsZS5mb3JDaGlsZCh7IHN0YXRlczogWyBob21lU3RhdGUsIGFib3V0U3RhdGUgXSB9KSxcbiAgICogICAgIFNoYXJlZE1vZHVsZSxcbiAgICogICBdLFxuICAgKiAgIGRlY2xhcmF0aW9uczogWyBIb21lLCBBYm91dCBdLFxuICAgKiB9KVxuICAgKiBleHBvcnQgY2xhc3MgQXBwTW9kdWxlIHt9O1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIG1vZHVsZSBVSS1Sb3V0ZXIgbW9kdWxlIG9wdGlvbnNcbiAgICogQHJldHVybnMgYW4gYE5nTW9kdWxlYFxuICAgKi9cbiAgc3RhdGljIGZvckNoaWxkKG1vZHVsZTogU3RhdGVzTW9kdWxlID0ge30pOiBNb2R1bGVXaXRoUHJvdmlkZXJzPFVJUm91dGVyTW9kdWxlPiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5nTW9kdWxlOiBVSVJvdXRlck1vZHVsZSxcbiAgICAgIHByb3ZpZGVyczogbWFrZUNoaWxkUHJvdmlkZXJzKG1vZHVsZSksXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFVJLVJvdXRlciBkZWNsYXJhdGl2ZSBjb25maWd1cmF0aW9uIHdoaWNoIGNhbiBiZSBwcm92aWRlZCB0byBbW1VJUm91dGVyTW9kdWxlLmZvclJvb3RdXVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJvb3RNb2R1bGUgZXh0ZW5kcyBTdGF0ZXNNb2R1bGUge1xuICAvKipcbiAgICogQ2hvb3NlcyBhIGBMb2NhdGlvblN0cmF0ZWd5YC5cbiAgICpcbiAgICogVGhlIGxvY2F0aW9uIHN0cmF0ZWd5IGVuYWJsZXMgZWl0aGVyIEhUTUw1IFB1c2ggU3RhdGVcbiAgICogKFJlcXVpcmVzIHNlcnZlci1zaWRlIHN1cHBvcnQpIG9yIFwiSGFzaEJhbmdcIiBVUkxzLlxuICAgKlxuICAgKiBXaGVuIGBmYWxzZWAsIHVzZXMgW2BQYXRoTG9jYXRpb25TdHJhdGVneWBdKGh0dHBzOi8vYW5ndWxhci5pby9kb2NzL3RzL2xhdGVzdC9hcGkvY29tbW9uL2luZGV4L1BhdGhMb2NhdGlvblN0cmF0ZWd5LWNsYXNzLmh0bWwpXG4gICAqIFdoZW4gYHRydWVgLCB1c2VzIFtgSGFzaExvY2F0aW9uU3RyYXRlZ3lgXShodHRwczovL2FuZ3VsYXIuaW8vZG9jcy90cy9sYXRlc3QvYXBpL2NvbW1vbi9pbmRleC9IYXNoTG9jYXRpb25TdHJhdGVneS1jbGFzcy5odG1sKVxuICAgKlxuICAgKiBEZWZhdWx0cyB0byBgZmFsc2VgXG4gICAqL1xuICB1c2VIYXNoPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogQ29uZmlndXJlcyB0aGUgYG90aGVyd2lzZWAgcnVsZSwgd2hpY2ggY2hvb3NlcyB0aGUgc3RhdGUgb3IgVVJMIHRvIGFjdGl2YXRlIHdoZW4gbm8gb3RoZXIgcm91dGVzIG1hdGNoZWQuXG4gICAqXG4gICAqIFNlZTogW1tVcmxSdWxlc0FwaS5vdGhlcndpc2VdXS5cbiAgICovXG4gIG90aGVyd2lzZT86IHN0cmluZyB8IFVybFJ1bGVIYW5kbGVyRm4gfCBUYXJnZXRTdGF0ZSB8IFRhcmdldFN0YXRlRGVmO1xuXG4gIC8qKlxuICAgKiBDb25maWd1cmVzIHRoZSBgaW5pdGlhbGAgcnVsZSwgd2hpY2ggY2hvb3NlcyB0aGUgc3RhdGUgb3IgVVJMIHRvIGFjdGl2YXRlIHdoZW4gdGhlXG4gICAqIGFwcGxpY2F0aW9uIGluaXRpYWxseSBzdGFydHMsIGFuZCBubyBvdGhlciByb3V0ZXMgbWF0Y2hlZC5cbiAgICpcbiAgICogU2VlOiBbW1VybFJ1bGVzQXBpLmluaXRpYWxdXS5cbiAgICovXG4gIGluaXRpYWw/OiBzdHJpbmcgfCBVcmxSdWxlSGFuZGxlckZuIHwgVGFyZ2V0U3RhdGUgfCBUYXJnZXRTdGF0ZURlZjtcblxuICAvKipcbiAgICogU2V0cyBbW1VybFJvdXRlclByb3ZpZGVyLmRlZmVySW50ZXJjZXB0XV1cbiAgICovXG4gIGRlZmVySW50ZXJjZXB0PzogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGVsbHMgQW5ndWxhciB0byBkZWZlciB0aGUgZmlyc3QgcmVuZGVyIHVudGlsIGFmdGVyIHRoZSBpbml0aWFsIHRyYW5zaXRpb24gaXMgY29tcGxldGUuXG4gICAqXG4gICAqIFdoZW4gYHRydWVgLCBhZGRzIGFuIGFzeW5jIGBBUFBfSU5JVElBTElaRVJgIHdoaWNoIGlzIHJlc29sdmVkIGFmdGVyIGFueSBgb25TdWNjZXNzYCBvciBgb25FcnJvcmAuXG4gICAqIFRoZSBpbml0aWFsaXplciBzdG9wcyBhbmd1bGFyIGZyb20gcmVuZGVyaW5nIHRoZSByb290IGNvbXBvbmVudCB1bnRpbCBhZnRlciB0aGUgZmlyc3QgdHJhbnNpdGlvbiBjb21wbGV0ZXMuXG4gICAqIFRoaXMgbWF5IHByZXZlbnQgaW5pdGlhbCBwYWdlIGZsaWNrZXIgd2hpbGUgdGhlIHN0YXRlIGlzIGJlaW5nIGxvYWRlZC5cbiAgICpcbiAgICogRGVmYXVsdHMgdG8gYGZhbHNlYFxuICAgKi9cbiAgZGVmZXJJbml0aWFsUmVuZGVyPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBVSS1Sb3V0ZXIgTW9kdWxlIGRlY2xhcmF0aXZlIGNvbmZpZ3VyYXRpb24gd2hpY2ggY2FuIGJlIHBhc3NlZCB0byBbW1VJUm91dGVyTW9kdWxlLmZvckNoaWxkXV1cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTdGF0ZXNNb2R1bGUge1xuICAvKipcbiAgICogVGhlIG1vZHVsZSdzIFVJLVJvdXRlciBzdGF0ZXNcbiAgICpcbiAgICogVGhpcyBsaXN0IG9mIFtbTmcyU3RhdGVEZWNsYXJhdGlvbl1dIG9iamVjdHMgd2lsbCBiZSByZWdpc3RlcmVkIHdpdGggdGhlIFtbU3RhdGVSZWdpc3RyeV1dLlxuICAgKi9cbiAgc3RhdGVzPzogTmcyU3RhdGVEZWNsYXJhdGlvbltdO1xuXG4gIC8qKlxuICAgKiBBIFVJLVJvdXRlciBNb2R1bGUncyBpbXBlcmF0aXZlIGNvbmZpZ3VyYXRpb25cbiAgICpcbiAgICogSWYgYSBVSS1Sb3V0ZXIgTW9kdWxlIG5lZWRzIHRvIHBlcmZvcm0gc29tZSBjb25maWd1cmF0aW9uIChzdWNoIGFzIHJlZ2lzdGVyaW5nXG4gICAqIHBhcmFtZXRlciB0eXBlcyBvciBUcmFuc2l0aW9uIEhvb2tzKSBhIGBjb25maWdGbmAgc2hvdWxkIGJlIHN1cHBsaWVkLlxuICAgKiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBwYXNzZWQgdGhlIGBVSVJvdXRlcmAgaW5zdGFuY2UsIHRoZSBtb2R1bGUncyBgSW5qZWN0b3JgLFxuICAgKiBhbmQgdGhlIG1vZHVsZSBvYmplY3QuXG4gICAqXG4gICAqICMjIyMgRXhhbXBsZTpcbiAgICogYGBganNcbiAgICogaW1wb3J0IHsgSW5qZWN0b3IgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuICAgKiBpbXBvcnQgeyBVSVJvdXRlciB9IGZyb20gXCJAdWlyb3V0ZXIvYW5ndWxhclwiO1xuICAgKiBpbXBvcnQgeyByZXF1aXJlQXV0aEhvb2sgfSBmcm9tIFwiLi9yZXF1aXJlQXV0aEhvb2tcIjtcbiAgICogaW1wb3J0IHsgTXlTZXJ2aWNlIH0gZnJvbSBcIi4vbXlTZXJ2aWNlXCI7XG4gICAqXG4gICAqIGV4cG9ydCBmdW5jdGlvbiBjb25maWd1cmVNeU1vZHVsZSh1aVJvdXRlcjogVUlSb3V0ZXIsIGluamVjdG9yOiBJbmplY3RvciwgbW9kdWxlOiBTdGF0ZXNNb2R1bGUpIHtcbiAgICogICAvLyBHZXQgVUlSb3V0ZXIgc2VydmljZXMgb2ZmIHRoZSBVSVJvdXRlciBvYmplY3RcbiAgICogICBsZXQgdXJsQ29uZmlnID0gdWlSb3V0ZXIudXJsU2VydmljZS5jb25maWc7XG4gICAqICAgbGV0IHRyYW5zaXRpb25TZXJ2aWNlID0gdWlSb3V0ZXIudHJhbnNpdGlvblNlcnZpY2U7XG4gICAqICAgdWlSb3V0ZXIudHJhY2UuZW5hYmxlKFwiVFJBTlNJVElPTlwiKTtcbiAgICpcbiAgICogICB0cmFuc2l0aW9uU2VydmljZS5vbkJlZm9yZSh7IHRvOiAoc3RhdGUpID0+IHN0YXRlLnJlcXVpcmVzQXV0aCB9LCByZXF1aXJlQXV0aEhvb2spO1xuICAgKlxuICAgKiAgIC8vIENyZWF0ZSBhIHNsdWcgdHlwZSBiYXNlZCBvbiB0aGUgc3RyaW5nIHR5cGVcbiAgICogICBsZXQgYnVpbHRJblN0cmluZ1R5cGUgPSB1cmxDb25maWcudHlwZSgnc3RyaW5nJyk7XG4gICAqICAgbGV0IHNsdWdUeXBlID0gT2JqZWN0LmFzc2lnbih7fSwgYnVpbHRJblN0cmluZ1R5cGUsIHsgZW5jb2RlOiAoc3RyKSA9PiBzdHIsIGRlY29kZTogKHN0cikgPT4gc3RyIH0pO1xuICAgKiAgIHVybENvbmZpZy50eXBlKCdzbHVnJywgc2x1Z1R5cGUpO1xuICAgKlxuICAgKiAgIC8vIEluamVjdCBhcmJpdHJhcnkgc2VydmljZXMgZnJvbSBESSB1c2luZyB0aGUgSW5qZWN0b3IgYXJndW1lbnRcbiAgICogICBsZXQgbXlTZXJ2aWNlOiBNeVNlcnZpY2UgPSBpbmplY3Rvci5nZXQoTXlTZXJ2aWNlKVxuICAgKiAgIG15U2VydmljZS51c2VGYXN0TW9kZSgpO1xuICAgKiB9XG4gICAqIGBgYFxuICAgKlxuICAgKiBgYGBqc1xuICAgKiBATmdNb2R1bGUoe1xuICAgKiAgIGltcG9ydHM6IFtcbiAgICogICAgIFVJUm91dGVyTW9kdWxlLmZvckNoaWxkKHsgc3RhdGVzOiBTVEFURVMsIGNvbmZpZzogY29uZmlndXJlTXlNb2R1bGUgfSk7XG4gICAqICAgXVxuICAgKiB9KVxuICAgKiBjbGFzcyBNeU1vZHVsZSB7fVxuICAgKiBgYGBcbiAgICovXG4gIGNvbmZpZz86ICh1aVJvdXRlckluc3RhbmNlOiBVSVJvdXRlciwgaW5qZWN0b3I6IEluamVjdG9yLCBtb2R1bGU6IFN0YXRlc01vZHVsZSkgPT4gYW55O1xufVxuIl19